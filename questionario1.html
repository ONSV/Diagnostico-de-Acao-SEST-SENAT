<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Questionário de Segurança Viária - ONSV</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #007bff;
            --background-light: #f4f7f6;
            --background-white: #ffffff;
            --text-dark: #343a40;
            --border-color: #e9ecef;
            --border-radius-lg: 12px;
            --border-radius-md: 8px;
            --box-shadow-light: 0 4px 12px rgba(0, 0, 0, 0.05);
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--background-light);
            padding: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .container-principal {
            width: 100%;
            max-width: 1024px;
            background: var(--background-white);
            border-radius: var(--border-radius-lg);
            box-shadow: var(--box-shadow-light);
            overflow: hidden;
        }

        .progresso-header {
            background: var(--primary-color);
            color: #fff;
            padding: 20px 30px;
        }

        .progresso-header h2 {
            margin: 0;
            font-weight: 600;
            font-size: 1.6rem;
            text-align: center;
        }

        #autoavaliacao-form {
            padding: 30px;
        }

        .pergunta {
            margin: 25px 0;
            padding: 20px;
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius-md);
        }

        .pergunta h4 {
            margin: 0 0 12px;
            font-size: 1.15rem;
            color: var(--text-dark);
            font-weight: 500;
        }

        .opcoes-resposta label {
            display: flex;
            gap: 12px;
            align-items: center;
            padding: 14px;
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius-md);
            margin: 10px 0;
            cursor: pointer;
        }

        .opcoes-resposta input[type="radio"] {
            min-width: 18px;
            min-height: 18px;
            accent-color: var(--primary-color);
        }

        .btn-submit {
            width: 100%;
            padding: 14px 25px;
            border: none;
            border-radius: var(--border-radius-md);
            font-weight: 600;
            cursor: pointer;
            font-size: 1rem;
            background: var(--primary-color);
            color: #fff;
            margin-top: 30px;
        }

        .btn-submit:disabled {
            background: #6c757d;
            cursor: not-allowed;
        }
    </style>
</head>

<body>

    <div class="container-principal">
        <header class="progresso-header">
            <h2>Autoavaliação de Segurança Viária</h2>
        </header>

        <form id="autoavaliacao-form" method="POST">
            <h1 class="text-2xl md:text-3xl font-bold text-center text-gray-800 mb-2">Questionário Pré-Ação</h1>
            <p class="text-center text-gray-600 mb-8">Teste seus conhecimentos sobre a segurança no trânsito no Brasil.
            </p>

            <div class="pergunta" data-question="q1">
                <h4 class="font-semibold text-lg text-gray-700 mb-3">1. Na sua opinião, o que mais influencia a
                    gravidade de um acidente de trânsito?</h4>
                <div class="opcoes-resposta space-y-2">
                    <label><input type="radio" name="q1" value="tipo_veiculo" required><span>O tipo de veículo
                            envolvido</span></label>
                    <label><input type="radio" name="q1" value="exp_condut"><span>A experiência do
                            condutor</span></label>
                    <label><input type="radio" name="q1" value="condi_via"><span>As condições da via</span></label>
                    <label><input type="radio" name="q1" value="equip_seg"><span>O uso ou não de equipamentos de
                            segurança</span></label>
                    <label><input type="radio" name="q1" value="velocidade"><span> A velocidade no momento do
                            impacto</span></label>
                </div>
            </div>

            <div class="pergunta" data-question="q2">
                <h4 class="font-semibold text-lg text-gray-700 mb-3">2. Quando ocorre um acidente grave, normalmente ele
                    acontece porque:</h4>
                <div class="opcoes-resposta space-y-2">
                    <label><input type="radio" name="q2" value="trans_imprev" required><span>O trânsito é
                            imprevisível</span></label>
                    <label><input type="radio" name="q2" value="fat_ext"><span>Sempre existe um fator externo fora do
                            controle</span></label>
                    <label><input type="radio" name="q2" value="mot_imprud"><span>O motorista foi imprudente naquele
                            momento</span></label>
                    <label><input type="radio" name="q2" value="imprevisivel"><span>É impossível prever tudo o que
                            acontece na via</span></label>
                    <label><input type="radio" name="q2" value="escolhas_comport"><span>Uma combinação de escolhas e
                            comportamentos de risco</span></label>
                </div>
            </div>

            <div class="pergunta" data-question="q3">
                <h4 class="font-semibold text-lg text-gray-700 mb-3">Usar o celular enquanto dirige é perigoso
                    principalmente porque:</h4>
                <div class="opcoes-resposta space-y-2">
                    <label><input type="radio" name="q3" value="visual" required><span>Diminui apenas a atenção
                            visual</span></label>
                    <label><input type="radio" name="q3" value="mot_inexp"><span>Atrapalha mais motoristas
                            inexperientes</span></label>
                    <label><input type="radio" name="q3" value="decisao"><span>Compromete atenção, reação e tomada de
                            decisão</span></label>
                    <label><input type="radio" name="q3" value="vias_rap"><span>Só é arriscado em vias
                            rápidas</span></label>
                    <label><input type="radio" name="q3" value="multas"><span>Pode causar multas e
                            punições</span></label>
                </div>
            </div>

            <div class="pergunta" data-question="q4">
                <h4 class="font-semibold text-lg text-gray-700 mb-3">Em um atropelamento, qual fator mais aumenta a
                    chance de morte do pedestre?</h4>
                <div class="opcoes-resposta space-y-2">
                    <label><input type="radio" name="q4" value="veloc_veic" required><span>A velocidade do
                            veículo</span></label>
                    <label><input type="radio" name="q4" value="reac"><span>A reação do pedestre</span></label>
                    <label><input type="radio" name="q4" value="faixa"><span>A presença ou não de faixa de
                            pedestres</span></label>
                    <label><input type="radio" name="q4" value="tam_veic"><span>O tamanho do veículo</span></label>
                    <label><input type="radio" name="q4" value="idade"><span>A idade da vítima</span></label>
                </div>
            </div>

            <div class="pergunta" data-question="q5">
                <h4 class="font-semibold text-lg text-gray-700 mb-3">5. Pensando na segurança do trânsito, quem tem
                    maior responsabilidade?</h4>
                <div class="opcoes-resposta space-y-2">
                    <label><input type="radio" name="q5" value="mot_prof" required><span>Os motoristas
                            profissionais</span></label>
                    <label><input type="radio" name="q5" value="motoc_exp"><span>Os motociclistas, por estarem mais
                            expostos</span></label>
                    <label><input type="radio" name="q5" value="fisc"><span>O poder público e a
                            fiscalização</span></label>
                    <label><input type="radio" name="q5" value="partic"><span>Todos que participam do
                            trânsito</span></label>
                    <label><input type="radio" name="q5" value="veic_maior"><span>Quem dirige veículos
                            maiores</span></label>
                </div>
            </div>

            <div class="pergunta" data-question="q6">
                <h4 class="font-semibold text-lg text-gray-700 mb-3">6. Qual das situações abaixo representa maior risco
                    no trânsito?</h4>
                <div class="opcoes-resposta space-y-2">
                    <label><input type="radio" name="q6" value="cel" required><span>Dirigir usando o celular, mesmo por
                            poucos segundos</span></label>
                    <label><input type="radio" name="q6" value="ultrap"><span>Ultrapassar quando a via parece
                            livre</span></label>
                    <label><input type="radio" name="q6" value="mens"><span>Responder rapidamente uma mensagem no
                            semáforo</span></label>
                    <label><input type="radio" name="q6" value="cansa"><span>Dirigir cansado após um dia de
                            trabalho</span></label>
                    <label><input type="radio" name="q6" value="acim_lim"><span>Dirigir um pouco acima do limite em uma
                            via conhecida</span></label>
                </div>
            </div>

            <div class="pergunta" data-question="q7">
                <h4 class="font-semibold text-lg text-gray-700 mb-3">7. Sobre acidentes de trânsito, qual afirmação você
                    considera mais correta?</h4>
                <div class="opcoes-resposta space-y-2">
                    <label><input type="radio" name="q7" value="sorte" required><span>A maioria acontece por falta de
                            sorte</span></label>
                    <label><input type="radio" name="q7" value="vida"><span>São parte normal da vida nas
                            cidades</span></label>
                    <label><input type="radio" name="q7" value="falh_mec"><span>Acontecem principalmente por falhas
                            mecânicas</span></label>
                    <label><input type="radio" name="q7" value="aum_frota"><span>São consequência do aumento da
                            frota</span></label>
                    <label><input type="radio" name="q7" value="comport"><span>Grande parte poderia ser evitada com
                            mudanças de comportamento</span></label>
                </div>
            </div>

            <div class="pergunta" data-question="q8">
                <h4 class="font-semibold text-lg text-gray-700 mb-3">8. Para um motociclista, qual item faz maior
                    diferença na chance de sobreviver a um acidente?</h4>
                <div class="opcoes-resposta space-y-2">
                    <label><input type="radio" name="q8" value="roup" required><span>Roupa grossa</span></label>
                    <label><input type="radio" name="q8" value="botas"><span>Botas fechadas</span></label>
                    <label><input type="radio" name="q8" value="cap"><span>Capacete de boa qualidade</span></label>
                    <label><input type="radio" name="q8" value="luva"><span>Luvas reforçadas</span></label>
                    <label><input type="radio" name="q8" value="jaq"><span>Jaqueta com proteção</span></label>
                </div>
            </div>

            <div class="pergunta" data-question="q9">
                <h4 class="font-semibold text-lg text-gray-700 mb-3">9. Estar com pressa no trânsito geralmente:</h4>
                <div class="opcoes-resposta space-y-2">
                    <label><input type="radio" name="q9" value="err" required><span>Aumenta a chance de erros e decisões
                            arriscadas</span></label>
                    <label><input type="radio" name="q9" value="perig"><span>Só é perigoso em rodovias</span></label>
                    <label><input type="radio" name="q9" value="nai_interf"><span>Não interfere, desde que o motorista
                            seja experiente</span></label>
                    <label><input type="radio" name="q9" value="reduz"><span>Reduz o tempo de exposição ao
                            risco</span></label>
                    <label><input type="radio" name="q9" value="atenc"><span>Ajuda a manter mais atenção</span></label>

                </div>
            </div>

            <div class="pergunta" data-question="q10">
                <h4 class="font-semibold text-lg text-gray-700 mb-3">10. Qual frase melhor representa uma postura segura
                    no trânsito?</h4>
                <div class="opcoes-resposta space-y-2">
                    <label><input type="radio" name="q10" value="vacilao" required><span>“Acidentes acontecem com quem
                            vacila”</span></label>
                    <label><input type="radio" name="q10" value="minhas_esc"><span>“Minhas escolhas no trânsito afetam a
                            vida de outras pessoas”</span></label>
                    <label><input type="radio" name="q10" value="respeito"><span>“Se todo mundo respeitasse, não teria
                            problema”</span></label>
                    <label><input type="radio" name="q10" value="hor"><span>“O importante é chegar no
                            horário”</span></label>
                    <label><input type="radio" name="q10" value="sabe"><span>“Quem sabe dirigir consegue evitar
                            acidentes”</span></label>
                </div>
            </div>

            <div class="pergunta">
                <h4 class="font-semibold text-lg text-gray-700 mb-3">11. O que mais te preocupa quando pensa em
                    segurança no trânsito?</h4>
                <div><textarea name="respostaQ11" id="q11" rows="4" class="w-full p-3 border rounded-lg"
                        placeholder="Digite sua resposta aqui..." required></textarea></div>
            </div>

            <div id="hidden-fields"></div>

            <button type="submit" class="btn-submit">Enviar Respostas</button>
        </form>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // COLE AQUI A SUA URL DO WEB APP (A QUE TERMINA COM /exec)
            const WEB_APP_URL = 'https://script.google.com/a/macros/onsv.org.br/s/AKfycbyn6VGsEVv3Uv0Q26oOdTF91Za1tvlfWsuWrNoBXYiuZn6kRSUdxKhttt6Yy6Zt3Mtrjw/exec';

            const form = document.getElementById('autoavaliacao-form');
            form.action = WEB_APP_URL; // Define o destino do formulário

            const correctAnswers = { q1: 'velocidade', q2: 'escolhas_comport', q3: 'decisao', q4: 'veloc_veic', q5: 'partic', q6: 'cel', q7: 'comport', q8: 'cap', q9: 'err', q10: 'minhas_esc' };

            form.addEventListener('submit', function (event) {
                event.preventDefault(); // Impede o envio imediato para podermos calcular e preencher

                if (!form.checkValidity()) {
                    alert('Por favor, responda a todas as perguntas para continuar.');
                    return;
                }

                form.querySelector('.btn-submit').disabled = true;
                form.querySelector('.btn-submit').textContent = 'Enviando...';

                // Calcula a pontuação
                let score = 0;
                Object.keys(correctAnswers).forEach(key => {
                    const selected = form.querySelector(`input[name="${key}"]:checked`);
                    if (selected && selected.value === correctAnswers[key]) score++;
                });

                const urlParams = new URLSearchParams(window.location.search);

                // Cria os campos invisíveis com todos os dados necessários
                const hiddenFieldsContainer = document.getElementById('hidden-fields');
                const dadosParaEnviar = {
                    questionarioTipo: 1,
                    pontuacao: score,
                    nome: urlParams.get('nome') || '',
                    cpf: urlParams.get('cpf') || '',
                    email: urlParams.get('email') || '',
                    cidade: urlParams.get('cidade') || '',
                    estado: urlParams.get('estado') || '',
                    van: urlParams.get('van') || ''
                };

                for (const key in dadosParaEnviar) {
                    const input = document.createElement('input');
                    input.type = 'hidden';
                    input.name = key;
                    input.value = dadosParaEnviar[key];
                    hiddenFieldsContainer.appendChild(input);
                }

                // Agora, envia o formulário de verdade
                form.submit();
            });
        });
    </script>

</body>

</html>